#Load Environment
cd ./kernel/kernel-4.9/
source ../../environment_nvidia
sudo ./scripts/rt-patch.sh apply-patches

#DSBOARD_NX2 for Jetson Nano
make ARCH=arm64 O=$HOME/kernel_out_dsboard_nx2_nano dsboard_nx2_nano_defconfig
#make ARCH=arm64 O=$HOME/kernel_out_dsboard_nx2_nano menuconfig 
#make ARCH=arm64 O=$HOME/kernel_out_dsboard_nx2_nano savedefconfig 
#make mrproper
make ARCH=arm64 O=$HOME/kernel_out_dsboard_nx2_nano -j$(($(nproc)-1))

#Install the modules
sudo make ARCH=arm64 O=$HOME/kernel_out_dsboard_nx2_nano modules_install INSTALL_MOD_PATH=$HOME/nvidia/nvidia_sdk/JetPack_4.5.1_Linux_JETSON_NANO/Linux_for_Tegra/rootfs/

#Copy the Image and dtb file
cp $HOME/kernel_out_dsboard_nx2_nano/arch/arm64/boot/Image $HOME/nvidia/nvidia_sdk/JetPack_4.5.1_Linux_JETSON_NANO/Linux_for_Tegra/kernel/Image
cp $HOME/kernel_out_dsboard_nx2_nano/arch/arm64/boot/dts/tegra210-p3448-0002-dsboard-nx2-b00.dtb $HOME/nvidia/nvidia_sdk/JetPack_4.5.1_Linux_JETSON_NANO/Linux_for_Tegra/kernel/dtb/tegra210-p3448-0002-p3449-0000-b00.dtb

